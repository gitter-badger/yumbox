(function(){var e,t;t=window.sys.modules.home,e=function(e,s,n,i,o,a,r,c,u,l){var g;return g={assign:function(){return e.skipped_walkthroughs={pms:!1},e.currentUser=u.currentUser,e.pmses=window.sys.defaults.pmses,e.views=t.constants.views,e.views.analytics.state=e.views.states.loaded,e.views.feed.state=e.views.states.loaded,e.camera={working:!0,snackbar:!1,scanning:!1},e.bookings=[],e.guests={checkins:{list:[],total:0},checkouts:{list:[],total:0}},e.reviews={list:[],total:0},e.analytics={guests:{count:0},activities:{views:0,attendees:0}}},walk:function(){return e.introOptions={steps:[{element:$("#menu-icon")[0],intro:"<h4>Menu</h4><p>Main menu to navigate to other pages such as activities, analytics, settings and more</p>",position:"right"},{element:$("#search-btn")[0],intro:"<h4>Search</h4><p>You can search system wide for almost anything you want</p>",position:"left"},{element:$("#guests")[0],intro:"<h4>Check-in/out</h4><p>Check-in/out your guests easily. Know your guests better by reviewing their profile and suggest relevant events to them.</p>",position:"right"},{element:$("#new-activity-btn")[0],intro:"<h4>Activity</h4><p>Create activities and events. Your guests will be informed automatically.</p>",position:"left"},{element:$("#reviews")[0],intro:"<h4>Reviews</h4><p>You can see latest reviews from your guests here. You can easily publish these reviews on your website using review add-on.</p>",position:"top"},{element:$("#bookings")[0],intro:"<h4>Claimed Bookings</h4><p>As soon as someone claim a booking in your hostel, you will see a notification poping up here.</p>",position:"top"},{element:$("#analytics")[0],intro:"<h4>Analytics</h4><p>Monitor your hostel performance in a snapshot here or check the detailed analytics in <a>Analytics</a> page.</p>",position:"left"}],nextLabel:"Next",prevLabel:"Previous",skipLabel:"Skip",doneLabel:"Thanks",exitOnOverlayClick:!1,showStepNumbers:!1,showBullets:!1,showProgress:!0,disableInteraction:!0},e.$apply(),e.currentUser.settings.walkthrough.first_time?void 0:e.intro()},load:function(){return o.get(t.endpoints.checkins,{cache:!1}).success(function(t){return e.views.guests.state=e.views.states.loaded,e.guests.checkins=t.data,r.setCheckins(e.guests.checkins.list)}).error(function(t,s){return 401===s?e.views.guests.state=e.views.states.no_access:void 0}),o.get(t.endpoints.checkouts,{cache:!1}).success(function(t){return e.views.guests.state=e.views.states.loaded,e.guests.checkouts=t.data,r.setCheckouts(e.guests.checkouts.list)}).error(function(t,s){return 401===s?e.views.guests.state=e.views.states.no_access:void 0}),o.get(t.endpoints.activities,{cache:!1}).success(function(t){return e.views.activities.state=e.views.states.loaded,e.activities=t.data}).error(function(t,s){return 401===s?e.views.activities.state=e.views.states.no_access:void 0}),o.get(t.endpoints.reviews.list).success(function(t){return e.views.reviews.state=e.views.states.loaded,e.reviews=t.data}).error(function(t,s){return 401===s?e.views.reviews.state=e.views.states.no_access:void 0}),o.get(t.endpoints.analytics.guests.count).success(function(t){return e.analytics.guests.count=t.data})},events:{assign:function(){return e.accept_booking=g.events.bookings.accept,e.reject_booking=g.events.bookings.reject,e.success=g.events.success,e.error=g.events.error,e.scanner=g.events.scanner,e.skip=g.events.skip,e.introSkipped=g.events.intro.done,e.introDone=g.events.intro.done,e.seen=g.events.seen},seen:function(s,n){return o.post(t.endpoints.reviews.seen.replace(":id",s)).then(function(t){return e.reviews.list.splice(n,1),e.reviews.total--})},intro:{done:function(){return s.$broadcast(window.sys.modules.app.events.walkthrough.skipped,{name:"first_time",status:!0})}},skip:function(t,n){return e.skipped_walkthroughs.pms=!0,s.$broadcast(window.sys.modules.app.events.walkthrough.skipped,{name:t,status:n})},success:function(s){return console.log("scaned!!!!",s),e.camera.scanning=!1,e.camera.message="scanned "+s,e.camera.snackbar=!0,o.get(t.endpoints.guests.by_user.replace(":id",s)).success(function(e){return n.go("guest",{id:e.data.doc_key,user_key:s})})},error:function(t){return e.camera.working=!1,e.camera.message="is disabled! Reload the page",e.camera.snackbar=!0},scanner:{shoot:function(){return e.camera.scanning=!e.camera.scanning}},bookings:{accept:function(s,n){return o.post(t.endpoints.guests.accept.replace(":id",s.doc_key)).then(function(t){return e.bookings.splice(n,1)})},reject:function(s,n){return o.post(t.endpoints.guests.reject.replace(":id",s.doc_key)).then(function(t){return e.bookings.splice(n,1)})}}},socket:function(){return c.on("error",function(t){return e.views.bookings.state=e.views.states.no_access}),c.emit("get_pending_guests",function(t){return e.views.bookings.state=e.views.states.loaded,e.bookings=t.data}),c.on("new_pending_guest",function(t){return t.is_new=!0,e.bookings.push(t)}),c.on("new_checkin",function(t){return e.guests.checkins.list.unshift(t),e.guests.checkins.total+=1})},charts:function(){var s,n;return s=function(e,t,s,n,i,o,a){return $("."+e).easyPieChart({trackColor:t,scaleColor:s,barColor:n,lineWidth:i,lineCap:o,size:a})},n=function(e,t,s,n,i,o,a,r,c,u,l,g,p){return $("."+e).sparkline(t,{type:"line",width:s,height:n,lineColor:i,fillColor:o,lineWidth:a,maxSpotColor:r,minSpotColor:c,spotColor:u,spotRadius:l,highlightSpotColor:g,highlightLineColor:p})},o.get(t.endpoints.analytics.activities.overal).success(function(t){return e.analytics.activities=t.data,s("main-pie","rgba(255,255,255,0.2)","rgba(255,255,255,0.5)","rgba(255,255,255,0.7)",7,"butt",148),s("sub-pie-1","#eee","#ccc","#2196F3",4,"butt",95),s("sub-pie-2","#eee","#ccc","#FFC107",4,"butt",95)}),o.get(t.endpoints.analytics.guests.overal).success(function(t){var s;return e.analytics.guests.list=t.data,s=[],$.each(e.analytics.guests.list,function(e,t){return s.push(t.checkins_count)}),n("guests-stats-line",s,85,45,"#fff","rgba(0,0,0,0)",1.25,"rgba(255,255,255,0.4)","rgba(255,255,255,0.4)","rgba(255,255,255,0.4)",3,"#fff","rgba(255,255,255,0.4)")})}},g.assign(),g.load(),g.events.assign(),g.socket(),g.charts(),l(g.walk,1e3)},e.$inject=t.controllers.base.inject,angular.module(t.name).controller(t.controllers.base.name,e)}).call(this);